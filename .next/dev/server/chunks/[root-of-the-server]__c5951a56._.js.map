{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/models.ts"],"sourcesContent":["import { z } from \"zod\";\n\nexport type InventoryItem = {\n  id: string;\n  name: string;\n  quantity: number;\n  stackable?: boolean;\n  maxStack?: number;\n};\n\nexport type User = {\n  _id?: string;\n  email: string;\n  passwordHash: string;\n  salt: string;\n  createdAt: string;\n};\n\nexport type CharacterStats = {\n  level: number;\n  xp: number;\n  hp: number;\n  energy: number;\n};\n\nexport type Character = {\n  _id?: string;\n  ownerId: string;\n  name: string;\n  sprite: string;\n  inventory: InventoryItem[];\n  stats: CharacterStats;\n  gold: number;\n  createdAt: string;\n  updatedAt: string;\n};\n\nexport type HouseFurniture = {\n  id: string;\n  name: string;\n  position: { x: number; y: number };\n};\n\nexport type HouseState = {\n  ownerId: string;\n  furniture: HouseFurniture[];\n};\n\nexport type FarmPlot = {\n  id: string;\n  seed: string | null;\n  plantedAt: string | null;\n  harvestReadyAt: string | null;\n};\n\nexport type FarmState = {\n  ownerId: string;\n  plots: FarmPlot[];\n};\n\nexport type ChatMessage = {\n  id: string;\n  ownerId: string;\n  characterName?: string;\n  message: string;\n  createdAt: string;\n};\n\nexport type OnlinePresence = {\n  ownerId: string;\n  lastPing: string;\n};\n\nexport type PlayerSessionState = {\n  ownerId: string;\n  characterId: string;\n  map: string;\n  position: { x: number; y: number };\n  updatedAt: string;\n};\n\nexport type QuickSlotLayout = {\n  ownerId: string;\n  slots: Array<string | null>;\n  updatedAt: string;\n};\n\nexport const registerSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(6)\n});\n\nexport const loginSchema = registerSchema;\n\nexport const characterCreateSchema = z.object({\n  ownerId: z.string().min(1),\n  name: z.string().min(3).max(20),\n  sprite: z.string().min(1)\n});\n\nexport const characterGoldSchema = z.object({\n  ownerId: z.string().min(1),\n  characterId: z.string().min(1),\n  amount: z.number().int().min(0).max(Number.MAX_SAFE_INTEGER)\n});\n\nexport const characterXpSchema = z.object({\n  ownerId: z.string().min(1),\n  characterId: z.string().min(1),\n  amount: z.number().int().min(1).max(10000)\n});\n\nexport const onlinePingSchema = z.object({\n  ownerId: z.string().min(1)\n});\n\nexport const inventoryItemSchema = z.object({\n  id: z.string().min(1),\n  name: z.string().min(1),\n  quantity: z.number().int().min(1),\n  stackable: z.boolean().optional(),\n  maxStack: z.number().int().min(1).optional()\n});\n\nexport const inventoryAddSchema = z.object({\n  ownerId: z.string().min(1),\n  item: inventoryItemSchema\n});\n\nexport const inventoryRemoveSchema = z.object({\n  ownerId: z.string().min(1),\n  itemId: z.string().min(1),\n  quantity: z.number().int().min(1)\n});\n\nexport const chatSendSchema = z.object({\n  ownerId: z.string().min(1),\n  name: z.string().min(1).max(20).optional(),\n  message: z.string().min(1).max(280)\n});\n\nexport const houseUpdateSchema = z.object({\n  ownerId: z.string().min(1),\n  furniture: z\n    .array(\n      z.object({\n        id: z.string().min(1),\n        name: z.string().min(1),\n        position: z.object({\n          x: z.number().min(0),\n          y: z.number().min(0)\n        })\n      })\n    )\n    .max(4)\n});\n\nexport const farmPlantSchema = z.object({\n  ownerId: z.string().min(1),\n  plotId: z.string().min(1),\n  seed: z.string().min(1)\n});\n\nexport const farmHarvestSchema = z.object({\n  ownerId: z.string().min(1),\n  plotId: z.string().min(1)\n});\n\nexport const forestKillSchema = z.object({\n  ownerId: z.string().min(1)\n});\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 149, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/db.ts"],"sourcesContent":["import { MongoClient, Collection, type Document } from \"mongodb\";\n\nlet client: MongoClient | null = null;\n\nconst uri = process.env.MONGODB_URI;\nconst parsedDbName = (() => {\n  if (!uri) return null;\n  try {\n    const url = new URL(uri);\n    const pathname = url.pathname.replace(/^\\//, \"\");\n    return pathname || null;\n  } catch {\n    return null;\n  }\n})();\n\nasync function getClient() {\n  if (!uri) {\n    throw new Error(\"MONGODB_URI não configurado\");\n  }\n\n  if (!client) {\n    client = new MongoClient(uri);\n    await client.connect();\n  }\n\n  return client;\n}\n\nexport async function getCollection<T extends Document = Document>(\n  name: string\n): Promise<Collection<T>> {\n  const cli = await getClient();\n  const dbName = process.env.MONGODB_DB || parsedDbName || \"simpleapp\";\n  return cli.db(dbName).collection<T>(name);\n}\n\nexport function hasMongoConnection() {\n  return Boolean(uri);\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,IAAI,SAA6B;AAEjC,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,eAAe,CAAC;IACpB,IAAI,CAAC,KAAK,OAAO;IACjB,IAAI;QACF,MAAM,MAAM,IAAI,IAAI;QACpB,MAAM,WAAW,IAAI,QAAQ,CAAC,OAAO,CAAC,OAAO;QAC7C,OAAO,YAAY;IACrB,EAAE,OAAM;QACN,OAAO;IACT;AACF,CAAC;AAED,eAAe;IACb,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,CAAC,QAAQ;QACX,SAAS,IAAI,sHAAW,CAAC;QACzB,MAAM,OAAO,OAAO;IACtB;IAEA,OAAO;AACT;AAEO,eAAe,cACpB,IAAY;IAEZ,MAAM,MAAM,MAAM;IAClB,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI,gBAAgB;IACzD,OAAO,IAAI,EAAE,CAAC,QAAQ,UAAU,CAAI;AACtC;AAEO,SAAS;IACd,OAAO,QAAQ;AACjB"}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/memoryStore.ts"],"sourcesContent":["import type {\n  ChatMessage,\n  Character,\n  FarmState,\n  HouseState,\n  InventoryItem,\n  OnlinePresence,\n  PlayerSessionState,\n  QuickSlotLayout,\n  User\n} from \"./models\";\nimport type { BestiaryProfile } from \"@/models/Bestiary\";\n\ntype MemoryDB = {\n  users: User[];\n  characters: Character[];\n  inventory: Record<string, InventoryItem[]>;\n  houses: HouseState[];\n  farms: FarmState[];\n  chat: ChatMessage[];\n  online: OnlinePresence[];\n  sessions: PlayerSessionState[];\n  quickSlots: QuickSlotLayout[];\n  bestiary: BestiaryProfile[];\n};\n\nconst memoryDb: MemoryDB = {\n  users: [],\n  characters: [],\n  inventory: {},\n  houses: [],\n  farms: [],\n  chat: [],\n  online: [],\n  sessions: [],\n  quickSlots: [],\n  bestiary: []\n};\n\nexport function getMemoryDB() {\n  return memoryDb;\n}\n"],"names":[],"mappings":";;;;AA0BA,MAAM,WAAqB;IACzB,OAAO,EAAE;IACT,YAAY,EAAE;IACd,WAAW,CAAC;IACZ,QAAQ,EAAE;IACV,OAAO,EAAE;IACT,MAAM,EAAE;IACR,QAAQ,EAAE;IACV,UAAU,EAAE;IACZ,YAAY,EAAE;IACd,UAAU,EAAE;AACd;AAEO,SAAS;IACd,OAAO;AACT"}},
    {"offset": {"line": 214, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/models/Bestiary.ts"],"sourcesContent":["import { z } from \"zod\";\n\nexport type BestiaryEntry = {\n  monsterId: number;\n  kills: number;\n  tier: number;\n};\n\nexport type BestiaryProfile = {\n  ownerId: string;\n  characterId: string;\n  entries: BestiaryEntry[];\n  updatedAt: string;\n};\n\nexport const BESTIARY_TIER_THRESHOLDS = [0, 5, 15, 30, 60, 120] as const;\nexport const BESTIARY_TIER_LABELS = [\"Comum\", \"Incomum\", \"Raro\", \"Épico\", \"Lendário\", \"Mítico\"] as const;\n\nexport function resolveBestiaryTier(kills: number) {\n  let tier = 0;\n  for (let i = 0; i < BESTIARY_TIER_THRESHOLDS.length; i++) {\n    if (kills >= BESTIARY_TIER_THRESHOLDS[i]) {\n      tier = i;\n    }\n  }\n  return Math.min(tier, BESTIARY_TIER_THRESHOLDS.length - 1);\n}\n\nexport const bestiaryUpdateSchema = z.object({\n  ownerId: z.string().min(1),\n  characterId: z.string().min(1),\n  monsterId: z.number().int().nonnegative()\n});\n\nexport const bestiaryGetSchema = z.object({\n  ownerId: z.string().min(1),\n  characterId: z.string().min(1)\n});\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAeO,MAAM,2BAA2B;IAAC;IAAG;IAAG;IAAI;IAAI;IAAI;CAAI;AACxD,MAAM,uBAAuB;IAAC;IAAS;IAAW;IAAQ;IAAS;IAAY;CAAS;AAExF,SAAS,oBAAoB,KAAa;IAC/C,IAAI,OAAO;IACX,IAAK,IAAI,IAAI,GAAG,IAAI,yBAAyB,MAAM,EAAE,IAAK;QACxD,IAAI,SAAS,wBAAwB,CAAC,EAAE,EAAE;YACxC,OAAO;QACT;IACF;IACA,OAAO,KAAK,GAAG,CAAC,MAAM,yBAAyB,MAAM,GAAG;AAC1D;AAEO,MAAM,uBAAuB,oLAAC,CAAC,MAAM,CAAC;IAC3C,SAAS,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IACxB,aAAa,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IAC5B,WAAW,oLAAC,CAAC,MAAM,GAAG,GAAG,GAAG,WAAW;AACzC;AAEO,MAAM,oBAAoB,oLAAC,CAAC,MAAM,CAAC;IACxC,SAAS,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IACxB,aAAa,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;AAC9B"}},
    {"offset": {"line": 266, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/repositories.ts"],"sourcesContent":["import { ObjectId, type OptionalUnlessRequiredId, type ModifyResult } from \"mongodb\";\nimport { getCollection, hasMongoConnection } from \"./db\";\nimport { getMemoryDB } from \"./memoryStore\";\nimport type {\n  ChatMessage,\n  Character,\n  CharacterStats,\n  FarmState,\n  HouseState,\n  InventoryItem,\n  OnlinePresence,\n  PlayerSessionState,\n  QuickSlotLayout,\n  User\n} from \"./models\";\nimport type { BestiaryProfile } from \"@/models/Bestiary\";\nimport { resolveBestiaryTier } from \"@/models/Bestiary\";\n\ntype CharacterDocument = Omit<Character, \"_id\"> & { _id: ObjectId };\ntype UserDocument = Omit<User, \"_id\"> & { _id: ObjectId };\n\nexport async function findUserByEmail(email: string) {\n  if (hasMongoConnection()) {\n    const users = await getCollection<UserDocument>(\"users\");\n    const doc = await users.findOne({ email });\n    return doc ? normalizeUser(doc) : null;\n  }\n\n  const memory = getMemoryDB();\n  return memory.users.find((user) => user.email === email) ?? null;\n}\n\nexport async function insertUser(user: User) {\n  if (hasMongoConnection()) {\n    const users = await getCollection<UserDocument>(\"users\");\n    const { _id, ...doc } = user;\n    const result = await users.insertOne(doc as OptionalUnlessRequiredId<UserDocument>);\n    return { ...doc, _id: String(result.insertedId) };\n  }\n\n  const memory = getMemoryDB();\n  const stored = { ...user, _id: new ObjectId().toHexString() };\n  memory.users.push(stored);\n  return stored;\n}\n\nexport async function countCharacters(ownerId: string) {\n  if (hasMongoConnection()) {\n    const characters = await getCollection<CharacterDocument>(\"characters\");\n    return characters.countDocuments({ ownerId });\n  }\n\n  const memory = getMemoryDB();\n  return memory.characters.filter((c) => c.ownerId === ownerId).length;\n}\n\nexport async function insertCharacter(character: Character) {\n  if (hasMongoConnection()) {\n    const characters = await getCollection<CharacterDocument>(\"characters\");\n    const { _id, ...doc } = character;\n    const result = await characters.insertOne(\n      doc as OptionalUnlessRequiredId<CharacterDocument>\n    );\n    return { ...doc, _id: String(result.insertedId) };\n  }\n\n  const memory = getMemoryDB();\n  const stored = { ...character, _id: new ObjectId().toHexString() };\n  memory.characters.push(stored);\n  return stored;\n}\n\nexport async function listCharacters(ownerId: string) {\n  if (hasMongoConnection()) {\n    const characters = await getCollection<CharacterDocument>(\"characters\");\n    const docs = await characters\n      .find({ ownerId })\n      .sort({ createdAt: 1 })\n      .limit(4)\n      .toArray();\n    return docs.map((doc) => normalizeCharacter(doc));\n  }\n\n  const memory = getMemoryDB();\n  return memory.characters.filter((c) => c.ownerId === ownerId).map((c) => ({ ...c }));\n}\n\nexport async function findCharacterById(ownerId: string, characterId: string) {\n  if (hasMongoConnection()) {\n    if (!ObjectId.isValid(characterId)) {\n      return null;\n    }\n    const characters = await getCollection<CharacterDocument>(\"characters\");\n    const doc = await characters.findOne({ ownerId, _id: new ObjectId(characterId) });\n    return doc ? normalizeCharacter(doc) : null;\n  }\n\n  const memory = getMemoryDB();\n  const character = memory.characters.find(\n    (c) => c.ownerId === ownerId && c._id === characterId\n  );\n  return character ? { ...character } : null;\n}\n\nexport async function updateCharacterStats(\n  ownerId: string,\n  characterId: string,\n  stats: CharacterStats\n) {\n  const payload = { ...stats };\n  const updatedAt = new Date().toISOString();\n  if (hasMongoConnection()) {\n    if (!ObjectId.isValid(characterId)) {\n      throw new Error(\"Personagem inválido\");\n    }\n    const characters = await getCollection<CharacterDocument>(\"characters\");\n    await characters.updateOne(\n      { ownerId, _id: new ObjectId(characterId) },\n      { $set: { stats: payload, updatedAt } }\n    );\n    const updated = await characters.findOne({ ownerId, _id: new ObjectId(characterId) });\n    if (!updated) {\n      throw new Error(\"Personagem não encontrado\");\n    }\n    return normalizeCharacter(updated);\n  }\n\n  const memory = getMemoryDB();\n  const characterIndex = memory.characters.findIndex(\n    (c) => c.ownerId === ownerId && c._id === characterId\n  );\n  if (characterIndex < 0) {\n    throw new Error(\"Personagem não encontrado\");\n  }\n  memory.characters[characterIndex] = {\n    ...memory.characters[characterIndex],\n    stats: payload,\n    updatedAt\n  };\n  return { ...memory.characters[characterIndex] };\n}\n\nexport async function updateCharacterGold(ownerId: string, characterId: string, gold: number) {\n  const updatedAt = new Date().toISOString();\n  if (hasMongoConnection()) {\n    if (!ObjectId.isValid(characterId)) {\n      throw new Error(\"Personagem inválido\");\n    }\n    const characters = await getCollection<CharacterDocument>(\"characters\");\n    await characters.updateOne(\n      { ownerId, _id: new ObjectId(characterId) },\n      { $set: { gold, updatedAt } }\n    );\n    const updated = await characters.findOne({ ownerId, _id: new ObjectId(characterId) });\n    if (!updated) {\n      throw new Error(\"Personagem não encontrado\");\n    }\n    return normalizeCharacter(updated);\n  }\n\n  const memory = getMemoryDB();\n  const characterIndex = memory.characters.findIndex(\n    (c) => c.ownerId === ownerId && c._id === characterId\n  );\n  if (characterIndex < 0) throw new Error(\"Personagem não encontrado\");\n  memory.characters[characterIndex] = {\n    ...memory.characters[characterIndex],\n    gold,\n    updatedAt\n  };\n  return { ...memory.characters[characterIndex] };\n}\n\ntype BestiaryDocument = Omit<BestiaryProfile, \"_id\"> & { _id?: ObjectId };\n\nexport async function getBestiaryProfile(ownerId: string, characterId: string) {\n  if (hasMongoConnection()) {\n    const collection = await getCollection<BestiaryDocument>(\"bestiary\");\n    const doc = await collection.findOne({ ownerId, characterId });\n    return doc ?? null;\n  }\n\n  const memory = getMemoryDB();\n  return (\n    memory.bestiary.find(\n      (entry) => entry.ownerId === ownerId && entry.characterId === characterId\n    ) ?? null\n  );\n}\n\nexport async function incrementBestiaryKill(\n  ownerId: string,\n  characterId: string,\n  monsterId: number\n) {\n  const updatedAt = new Date().toISOString();\n  if (hasMongoConnection()) {\n    const collection = await getCollection<BestiaryDocument>(\"bestiary\");\n    const existing = await collection.findOne({ ownerId, characterId });\n    const profile: BestiaryProfile =\n      existing ?? {\n        ownerId,\n        characterId,\n        entries: [],\n        updatedAt\n      };\n    profile.entries = bumpBestiaryEntry(profile.entries, monsterId);\n    profile.updatedAt = updatedAt;\n    await collection.updateOne(\n      { ownerId, characterId },\n      { $set: profile },\n      { upsert: true }\n    );\n    return profile;\n  }\n\n  const memory = getMemoryDB();\n  let profile = memory.bestiary.find(\n    (entry) => entry.ownerId === ownerId && entry.characterId === characterId\n  );\n  if (!profile) {\n    profile = {\n      ownerId,\n      characterId,\n      entries: [],\n      updatedAt\n    };\n    memory.bestiary.push(profile);\n  }\n  profile.entries = bumpBestiaryEntry(profile.entries, monsterId);\n  profile.updatedAt = updatedAt;\n  return { ...profile };\n}\n\nfunction bumpBestiaryEntry(entries: BestiaryProfile[\"entries\"], monsterId: number) {\n  const next = [...entries];\n  const entry = next.find((item) => item.monsterId === monsterId);\n  if (entry) {\n    entry.kills += 1;\n    entry.tier = resolveBestiaryTier(entry.kills);\n    return next;\n  }\n  next.push({\n    monsterId,\n    kills: 1,\n    tier: resolveBestiaryTier(1)\n  });\n  return next;\n}\n\nexport async function getInventory(ownerId: string) {\n  if (hasMongoConnection()) {\n    const inventory = await getCollection<{ ownerId: string; items: InventoryItem[] }>(\"inventory\");\n    const doc = await inventory.findOne({ ownerId });\n    return doc?.items ?? [];\n  }\n\n  const memory = getMemoryDB();\n  const items = memory.inventory[ownerId] ?? [];\n  memory.inventory[ownerId] = items;\n  return items;\n}\n\nexport async function saveInventory(ownerId: string, items: InventoryItem[]) {\n  if (hasMongoConnection()) {\n    const inventory = await getCollection<{ ownerId: string; items: InventoryItem[] }>(\"inventory\");\n    await inventory.updateOne(\n      { ownerId },\n      { $set: { ownerId, items } },\n      { upsert: true }\n    );\n    return items;\n  }\n\n  const memory = getMemoryDB();\n  memory.inventory[ownerId] = items;\n  return items;\n}\n\nexport async function getHouse(ownerId: string): Promise<HouseState> {\n  if (hasMongoConnection()) {\n    const houses = await getCollection<HouseState>(\"houses\");\n    const doc = await houses.findOne({ ownerId });\n    return (\n      doc ?? {\n        ownerId,\n        furniture: defaultFurniture()\n      }\n    );\n  }\n\n  const memory = getMemoryDB();\n  let house = memory.houses.find((h) => h.ownerId === ownerId);\n  if (!house) {\n    house = { ownerId, furniture: defaultFurniture() };\n    memory.houses.push(house);\n  }\n  return house;\n}\n\nexport async function updateHouse(ownerId: string, furniture: HouseState[\"furniture\"]) {\n  const state = { ownerId, furniture };\n  if (hasMongoConnection()) {\n    const houses = await getCollection<HouseState>(\"houses\");\n    await houses.updateOne({ ownerId }, { $set: state }, { upsert: true });\n    return state;\n  }\n\n  const memory = getMemoryDB();\n  const index = memory.houses.findIndex((h) => h.ownerId === ownerId);\n  if (index >= 0) {\n    memory.houses[index] = state;\n    return state;\n  }\n  memory.houses.push(state);\n  return state;\n}\n\nexport async function getFarm(ownerId: string): Promise<FarmState> {\n  if (hasMongoConnection()) {\n    const farms = await getCollection<FarmState>(\"farms\");\n    const doc = await farms.findOne({ ownerId });\n    return doc ?? { ownerId, plots: defaultFarmPlots() };\n  }\n\n  const memory = getMemoryDB();\n  let farm = memory.farms.find((f) => f.ownerId === ownerId);\n  if (!farm) {\n    farm = { ownerId, plots: defaultFarmPlots() };\n    memory.farms.push(farm);\n  }\n  return farm;\n}\n\nexport async function saveFarm(state: FarmState) {\n  if (hasMongoConnection()) {\n    const farms = await getCollection<FarmState>(\"farms\");\n    await farms.updateOne({ ownerId: state.ownerId }, { $set: state }, { upsert: true });\n    return state;\n  }\n\n  const memory = getMemoryDB();\n  const index = memory.farms.findIndex((f) => f.ownerId === state.ownerId);\n  if (index >= 0) {\n    memory.farms[index] = state;\n    return state;\n  }\n  memory.farms.push(state);\n  return state;\n}\n\nexport async function getPlayerSession(ownerId: string) {\n  if (hasMongoConnection()) {\n    const sessions = await getCollection<PlayerSessionState>(\"sessions\");\n    return sessions.findOne({ ownerId });\n  }\n\n  const memory = getMemoryDB();\n  return memory.sessions.find((session) => session.ownerId === ownerId) ?? null;\n}\n\nexport async function savePlayerSession(state: PlayerSessionState) {\n  const payload = { ...state, updatedAt: new Date().toISOString() };\n  if (hasMongoConnection()) {\n    const sessions = await getCollection<PlayerSessionState>(\"sessions\");\n    await sessions.updateOne({ ownerId: state.ownerId }, { $set: payload }, { upsert: true });\n    return payload;\n  }\n\n  const memory = getMemoryDB();\n  const index = memory.sessions.findIndex((session) => session.ownerId === state.ownerId);\n  if (index >= 0) {\n    memory.sessions[index] = payload;\n  } else {\n    memory.sessions.push(payload);\n  }\n  return payload;\n}\n\nexport async function clearPlayerSession(ownerId: string) {\n  if (hasMongoConnection()) {\n    const sessions = await getCollection<PlayerSessionState>(\"sessions\");\n    await sessions.deleteOne({ ownerId });\n    return;\n  }\n\n  const memory = getMemoryDB();\n  memory.sessions = memory.sessions.filter((session) => session.ownerId !== ownerId);\n}\n\nexport async function getQuickSlots(ownerId: string) {\n  if (hasMongoConnection()) {\n    const layout = await getCollection<QuickSlotLayout>(\"quickslots\");\n    const doc = await layout.findOne({ ownerId });\n    return doc?.slots ?? defaultQuickSlots();\n  }\n\n  const memory = getMemoryDB();\n  const existing = memory.quickSlots.find((slot) => slot.ownerId === ownerId);\n  if (!existing) {\n    const created = { ownerId, slots: defaultQuickSlots(), updatedAt: new Date().toISOString() };\n    memory.quickSlots.push(created);\n    return created.slots;\n  }\n  return existing.slots;\n}\n\nexport async function saveQuickSlots(ownerId: string, slots: Array<string | null>) {\n  const payload: QuickSlotLayout = {\n    ownerId,\n    slots,\n    updatedAt: new Date().toISOString()\n  };\n  if (hasMongoConnection()) {\n    const layout = await getCollection<QuickSlotLayout>(\"quickslots\");\n    await layout.updateOne({ ownerId }, { $set: payload }, { upsert: true });\n    return payload.slots;\n  }\n\n  const memory = getMemoryDB();\n  const index = memory.quickSlots.findIndex((slot) => slot.ownerId === ownerId);\n  if (index >= 0) {\n    memory.quickSlots[index] = payload;\n  } else {\n    memory.quickSlots.push(payload);\n  }\n  return payload.slots;\n}\n\nexport async function addChatMessage(message: ChatMessage) {\n  if (hasMongoConnection()) {\n    const chat = await getCollection<ChatMessage>(\"chat\");\n    await chat.insertOne(message);\n    return message;\n  }\n\n  const memory = getMemoryDB();\n  memory.chat.push(message);\n  memory.chat = memory.chat.slice(-50);\n  return message;\n}\n\nexport async function listChatMessages(limit = 20) {\n  if (hasMongoConnection()) {\n    const chat = await getCollection<ChatMessage>(\"chat\");\n    const docs = await chat.find({}, { sort: { createdAt: -1 } }).limit(limit).toArray();\n    return docs.reverse();\n  }\n\n  const memory = getMemoryDB();\n  return memory.chat.slice(-limit);\n}\n\nexport async function pingOnline(ownerId: string) {\n  const entry: OnlinePresence = { ownerId, lastPing: new Date().toISOString() };\n  if (hasMongoConnection()) {\n    const online = await getCollection<OnlinePresence>(\"online\");\n    await online.updateOne({ ownerId }, { $set: entry }, { upsert: true });\n    return entry;\n  }\n\n  const memory = getMemoryDB();\n  const index = memory.online.findIndex((o) => o.ownerId === ownerId);\n  if (index >= 0) {\n    memory.online[index] = entry;\n  } else {\n    memory.online.push(entry);\n  }\n  return entry;\n}\n\nexport async function listOnline() {\n  const cutoff = Date.now() - 1000 * 60;\n  if (hasMongoConnection()) {\n    const online = await getCollection<OnlinePresence>(\"online\");\n    const docs = await online\n      .find({ lastPing: { $gte: new Date(cutoff).toISOString() } })\n      .toArray();\n    return docs;\n  }\n\n  const memory = getMemoryDB();\n  return memory.online.filter((o) => new Date(o.lastPing).getTime() >= cutoff);\n}\n\nfunction normalizeCharacter(\n  doc: CharacterDocument | (Character & { _id?: any })\n): Character {\n  const normalizedId =\n    typeof doc._id === \"string\" ? doc._id : doc._id?.toString?.();\n  return {\n    ...(structuredCloneCharacter(doc)),\n    _id: normalizedId\n  };\n}\n\nfunction normalizeUser(doc: UserDocument): User {\n  const normalizedId =\n    typeof doc._id === \"string\" ? doc._id : doc._id?.toString?.();\n  return {\n    ...(structuredCloneUser(doc)),\n    _id: normalizedId\n  };\n}\n\nfunction structuredCloneCharacter(\n  doc: CharacterDocument | (Character & { _id?: any })\n): Character {\n  const { _id, ...rest } = doc as Character;\n  return { ...rest };\n}\n\nfunction structuredCloneUser(doc: UserDocument | (User & { _id?: any })): User {\n  const { _id, ...rest } = doc as User;\n  return { ...rest };\n}\n\nfunction defaultFurniture() {\n  return [\n    { id: \"bed\", name: \"Cama Simples\", position: { x: 64, y: 32 } },\n    { id: \"table\", name: \"Mesa Madeira\", position: { x: 32, y: 96 } },\n    { id: \"shelf\", name: \"Estante Pequena\", position: { x: 96, y: 32 } },\n    { id: \"lamp\", name: \"Lamparina\", position: { x: 128, y: 96 } }\n  ];\n}\n\nfunction defaultQuickSlots(): Array<string | null> {\n  return [null, null, null, null];\n}\n\nfunction defaultFarmPlots() {\n  return Array.from({ length: 4 }).map((_, index) => ({\n    id: `plot-${index + 1}`,\n    seed: null,\n    plantedAt: null,\n    harvestReadyAt: null\n  }));\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 929, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/api/online/service.ts"],"sourcesContent":["import { onlinePingSchema } from \"@/lib/models\";\nimport { listOnline, pingOnline } from \"@/lib/repositories\";\n\nexport async function ping(payload: unknown) {\n  const data = onlinePingSchema.parse(payload);\n  return pingOnline(data.ownerId);\n}\n\nexport async function listPresences() {\n  return listOnline();\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAgB;IACzC,MAAM,OAAO,mIAAgB,CAAC,KAAK,CAAC;IACpC,OAAO,IAAA,mIAAU,EAAC,KAAK,OAAO;AAChC;AAEO,eAAe;IACpB,OAAO,IAAA,mIAAU;AACnB"}},
    {"offset": {"line": 956, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/apiResponse.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nexport function ok<T>(data: T, status = 200) {\n  return NextResponse.json(data, { status });\n}\n\nexport function error(message: string, status = 400) {\n  return NextResponse.json({ error: message }, { status });\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,SAAS,GAAM,IAAO,EAAE,SAAS,GAAG;IACzC,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;QAAE;IAAO;AAC1C;AAEO,SAAS,MAAM,OAAe,EAAE,SAAS,GAAG;IACjD,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAQ,GAAG;QAAE;IAAO;AACxD"}},
    {"offset": {"line": 980, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/app/api/online/list/route.ts"],"sourcesContent":["import { listPresences } from \"@/api/online/service\";\nimport { ok } from \"@/lib/apiResponse\";\n\nexport async function GET() {\n  const list = await listPresences();\n  return ok(list);\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,OAAO,MAAM,IAAA,2IAAa;IAChC,OAAO,IAAA,0HAAE,EAAC;AACZ"}}]
}