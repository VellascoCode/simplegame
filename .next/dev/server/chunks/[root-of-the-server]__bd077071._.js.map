{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/factions.ts"],"sourcesContent":["export enum FactionId {\n  GoldenEagle = 0,\n  BlackSerpent = 1,\n  IronWolf = 2,\n  ScarletRaven = 3\n}\n\nexport const FACTION_IDS: FactionId[] = [\n  FactionId.GoldenEagle,\n  FactionId.BlackSerpent,\n  FactionId.IronWolf,\n  FactionId.ScarletRaven\n];\n\nexport const FACTION_NAMES: Record<FactionId, string> = {\n  [FactionId.GoldenEagle]: \"ÁGUIA DOURADA\",\n  [FactionId.BlackSerpent]: \"SERPENTE NEGRA\",\n  [FactionId.IronWolf]: \"LOBO DE FERRO\",\n  [FactionId.ScarletRaven]: \"CORVO ESCARLATE\"\n};\n\nexport type FactionName = FactionId;\nexport type FactionWarTeams = { teamA: FactionId[]; teamB: FactionId[] };\nexport type FactionWarState = FactionWarTeams & {\n  startedAt: string;\n  remaining: Record<FactionId, number>;\n};\n\nconst FACTION_CHANTS: Record<FactionId, readonly string[]> = {\n  [FactionId.GoldenEagle]: [\"Por Águia Dourada!\", \"Voe alto!\", \"Guardem a cidade!\"],\n  [FactionId.BlackSerpent]: [\"Deslizem!\", \"As sombras vencem!\", \"Mordida certeira!\"],\n  [FactionId.IronWolf]: [\"Uivem!\", \"Aço e coragem!\", \"Protejam o clã!\"],\n  [FactionId.ScarletRaven]: [\"Escarlate eterno!\", \"Corvos no céu!\", \"Ninguém passa!\"]\n};\n\nexport function getFactionChants(faction: FactionId) {\n  return FACTION_CHANTS[faction] ?? [];\n}\n\nexport function getRandomFaction(): FactionId {\n  const index = Math.floor(Math.random() * FACTION_IDS.length);\n  return FACTION_IDS[index];\n}\n\nexport function pickFactionTeams(): FactionWarTeams {\n  const shuffled = [...FACTION_IDS].sort(() => Math.random() - 0.5);\n  return {\n    teamA: shuffled.slice(0, 2),\n    teamB: shuffled.slice(2, 4)\n  };\n}\n\nexport function isOpposingFaction(\n  targetFaction: FactionId | undefined,\n  sourceFaction: FactionId | undefined,\n  warState?: FactionWarTeams | null\n) {\n  if (targetFaction === undefined || sourceFaction === undefined || !warState) return false;\n  const { teamA, teamB } = warState;\n  const sourceTeam = teamA.includes(sourceFaction) ? \"A\" : teamB.includes(sourceFaction) ? \"B\" : null;\n  const targetTeam = teamA.includes(targetFaction) ? \"A\" : teamB.includes(targetFaction) ? \"B\" : null;\n  if (!sourceTeam || !targetTeam) return false;\n  return sourceTeam !== targetTeam;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAO,IAAA,AAAK,mCAAA;;;;;WAAA;;AAOL,MAAM,cAA2B;;;;;CAKvC;AAEM,MAAM,gBAA2C;IACtD,GAAuB,EAAE;IACzB,GAAwB,EAAE;IAC1B,GAAoB,EAAE;IACtB,GAAwB,EAAE;AAC5B;AASA,MAAM,iBAAuD;IAC3D,GAAuB,EAAE;QAAC;QAAsB;QAAa;KAAoB;IACjF,GAAwB,EAAE;QAAC;QAAa;QAAsB;KAAoB;IAClF,GAAoB,EAAE;QAAC;QAAU;QAAkB;KAAkB;IACrE,GAAwB,EAAE;QAAC;QAAqB;QAAkB;KAAiB;AACrF;AAEO,SAAS,iBAAiB,OAAkB;IACjD,OAAO,cAAc,CAAC,QAAQ,IAAI,EAAE;AACtC;AAEO,SAAS;IACd,MAAM,QAAQ,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,YAAY,MAAM;IAC3D,OAAO,WAAW,CAAC,MAAM;AAC3B;AAEO,SAAS;IACd,MAAM,WAAW;WAAI;KAAY,CAAC,IAAI,CAAC,IAAM,KAAK,MAAM,KAAK;IAC7D,OAAO;QACL,OAAO,SAAS,KAAK,CAAC,GAAG;QACzB,OAAO,SAAS,KAAK,CAAC,GAAG;IAC3B;AACF;AAEO,SAAS,kBACd,aAAoC,EACpC,aAAoC,EACpC,QAAiC;IAEjC,IAAI,kBAAkB,aAAa,kBAAkB,aAAa,CAAC,UAAU,OAAO;IACpF,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG;IACzB,MAAM,aAAa,MAAM,QAAQ,CAAC,iBAAiB,MAAM,MAAM,QAAQ,CAAC,iBAAiB,MAAM;IAC/F,MAAM,aAAa,MAAM,QAAQ,CAAC,iBAAiB,MAAM,MAAM,QAAQ,CAAC,iBAAiB,MAAM;IAC/F,IAAI,CAAC,cAAc,CAAC,YAAY,OAAO;IACvC,OAAO,eAAe;AACxB"}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/factionWar.ts"],"sourcesContent":["import { FACTION_IDS, pickFactionTeams, type FactionName, type FactionWarState } from \"./factions\";\n\ntype GlobalWithWarState = typeof globalThis & {\n  __FACTION_WAR_STATE__?: {\n    state: FactionWarState;\n    timer?: NodeJS.Timeout;\n    resetTimer?: NodeJS.Timeout;\n  };\n};\n\nconst globalWar = globalThis as GlobalWithWarState;\nconst WAR_MEMBERS_PER_FACTION = 10;\nconst WAR_REFRESH_MS = 10 * 60 * 1000;\nconst WAR_FORCE_RESET_MS = 5 * 60 * 1000;\n\nfunction createWarState(): FactionWarState {\n  const { teamA, teamB } = pickFactionTeams();\n  const remaining: Record<FactionName, number> = Object.fromEntries(\n    FACTION_IDS.map((faction) => [\n      faction,\n      teamA.includes(faction) || teamB.includes(faction) ? WAR_MEMBERS_PER_FACTION : 0\n    ])\n  ) as Record<FactionName, number>;\n  return {\n    teamA,\n    teamB,\n    startedAt: new Date().toISOString(),\n    remaining\n  };\n}\n\nfunction ensureWarState() {\n  if (!globalWar.__FACTION_WAR_STATE__) {\n    globalWar.__FACTION_WAR_STATE__ = {\n      state: createWarState()\n    };\n    scheduleWarTimers();\n  }\n  return globalWar.__FACTION_WAR_STATE__!;\n}\n\nfunction scheduleWarTimers() {\n  const war = globalWar.__FACTION_WAR_STATE__;\n  if (!war) return;\n  if (war.timer) {\n    clearInterval(war.timer);\n  }\n  if (war.resetTimer) {\n    clearTimeout(war.resetTimer);\n  }\n  war.timer = setInterval(() => {\n    resetWarState();\n  }, WAR_REFRESH_MS);\n  war.resetTimer = setTimeout(() => {\n    resetWarState();\n  }, WAR_FORCE_RESET_MS);\n}\n\nfunction resetWarState() {\n  if (!globalWar.__FACTION_WAR_STATE__) {\n    globalWar.__FACTION_WAR_STATE__ = { state: createWarState() };\n  } else {\n    globalWar.__FACTION_WAR_STATE__!.state = createWarState();\n  }\n  scheduleWarTimers();\n}\n\nexport function getFactionWarState(): FactionWarState {\n  return ensureWarState().state;\n}\n\nexport function registerFactionDeath(faction: FactionName) {\n  const war = ensureWarState();\n  const { state } = war;\n  if (!(state.teamA.includes(faction) || state.teamB.includes(faction))) return;\n  state.remaining[faction] = Math.max(0, (state.remaining[faction] ?? 0) - 1);\n  const teamZero = (team: readonly FactionName[]) =>\n    team.every((entry) => (state.remaining[entry] ?? 0) <= 0);\n  if (teamZero(state.teamA) || teamZero(state.teamB)) {\n    resetWarState();\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAUA,MAAM,YAAY;AAClB,MAAM,0BAA0B;AAChC,MAAM,iBAAiB,KAAK,KAAK;AACjC,MAAM,qBAAqB,IAAI,KAAK;AAEpC,SAAS;IACP,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAA,qIAAgB;IACzC,MAAM,YAAyC,OAAO,WAAW,CAC/D,gIAAW,CAAC,GAAG,CAAC,CAAC,UAAY;YAC3B;YACA,MAAM,QAAQ,CAAC,YAAY,MAAM,QAAQ,CAAC,WAAW,0BAA0B;SAChF;IAEH,OAAO;QACL;QACA;QACA,WAAW,IAAI,OAAO,WAAW;QACjC;IACF;AACF;AAEA,SAAS;IACP,IAAI,CAAC,UAAU,qBAAqB,EAAE;QACpC,UAAU,qBAAqB,GAAG;YAChC,OAAO;QACT;QACA;IACF;IACA,OAAO,UAAU,qBAAqB;AACxC;AAEA,SAAS;IACP,MAAM,MAAM,UAAU,qBAAqB;IAC3C,IAAI,CAAC,KAAK;IACV,IAAI,IAAI,KAAK,EAAE;QACb,cAAc,IAAI,KAAK;IACzB;IACA,IAAI,IAAI,UAAU,EAAE;QAClB,aAAa,IAAI,UAAU;IAC7B;IACA,IAAI,KAAK,GAAG,YAAY;QACtB;IACF,GAAG;IACH,IAAI,UAAU,GAAG,WAAW;QAC1B;IACF,GAAG;AACL;AAEA,SAAS;IACP,IAAI,CAAC,UAAU,qBAAqB,EAAE;QACpC,UAAU,qBAAqB,GAAG;YAAE,OAAO;QAAiB;IAC9D,OAAO;QACL,UAAU,qBAAqB,CAAE,KAAK,GAAG;IAC3C;IACA;AACF;AAEO,SAAS;IACd,OAAO,iBAAiB,KAAK;AAC/B;AAEO,SAAS,qBAAqB,OAAoB;IACvD,MAAM,MAAM;IACZ,MAAM,EAAE,KAAK,EAAE,GAAG;IAClB,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,QAAQ,CAAC,YAAY,MAAM,KAAK,CAAC,QAAQ,CAAC,QAAQ,GAAG;IACvE,MAAM,SAAS,CAAC,QAAQ,GAAG,KAAK,GAAG,CAAC,GAAG,CAAC,MAAM,SAAS,CAAC,QAAQ,IAAI,CAAC,IAAI;IACzE,MAAM,WAAW,CAAC,OAChB,KAAK,KAAK,CAAC,CAAC,QAAU,CAAC,MAAM,SAAS,CAAC,MAAM,IAAI,CAAC,KAAK;IACzD,IAAI,SAAS,MAAM,KAAK,KAAK,SAAS,MAAM,KAAK,GAAG;QAClD;IACF;AACF"}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/lib/apiResponse.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\nexport function ok<T>(data: T, status = 200) {\n  return NextResponse.json(data, { status });\n}\n\nexport function error(message: string, status = 400) {\n  return NextResponse.json({ error: message }, { status });\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,SAAS,GAAM,IAAO,EAAE,SAAS,GAAG;IACzC,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;QAAE;IAAO;AAC1C;AAEO,SAAS,MAAM,OAAe,EAAE,SAAS,GAAG;IACjD,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAQ,GAAG;QAAE;IAAO;AACxD"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///Users/diegovellasco/simplegame/app/api/factions/war/route.ts"],"sourcesContent":["import { getFactionWarState, registerFactionDeath } from \"@/lib/factionWar\";\nimport { ok, error } from \"@/lib/apiResponse\";\nimport { z } from \"zod\";\nimport { FactionId } from \"@/lib/factions\";\n\nconst killSchema = z.object({\n  faction: z.nativeEnum(FactionId)\n});\n\nexport async function GET() {\n  return ok(getFactionWarState());\n}\n\nexport async function POST(request: Request) {\n  try {\n    const payload = killSchema.parse(await request.json());\n    registerFactionDeath(payload.faction);\n    return ok(getFactionWarState());\n  } catch (err) {\n    return error(err instanceof Error ? err.message : \"Falha ao registrar batalha\", 400);\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,aAAa,oLAAC,CAAC,MAAM,CAAC;IAC1B,SAAS,oLAAC,CAAC,UAAU,CAAC,8HAAS;AACjC;AAEO,eAAe;IACpB,OAAO,IAAA,0HAAE,EAAC,IAAA,yIAAkB;AAC9B;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,UAAU,WAAW,KAAK,CAAC,MAAM,QAAQ,IAAI;QACnD,IAAA,2IAAoB,EAAC,QAAQ,OAAO;QACpC,OAAO,IAAA,0HAAE,EAAC,IAAA,yIAAkB;IAC9B,EAAE,OAAO,KAAK;QACZ,OAAO,IAAA,6HAAK,EAAC,eAAe,QAAQ,IAAI,OAAO,GAAG,8BAA8B;IAClF;AACF"}}]
}